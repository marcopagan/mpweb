import{av as ge,Q as Z,R as W,T as me,V as H,s as D,i as y,y as M,v as ye,j as X,h as Ee,g as C,ak as pe,k as we,l as be,m as j,n as k,t as I,Y as Ae,o as se,p as ie,q as Te,aw as fe,a0 as le,S as Se,an as Ie,ad as $,ax as q,af as xe,ay as B,az as Me,aA as J,aB as ee,aC as Ce,$ as Ne,aD as Re,a6 as De,aE as He,x as oe,F as z,aF as Le,Z as Oe,X as ke,A as qe,K as Y,D as Ye,M as V,C as Ve,G as Xe,I as ze,J as te}from"./BO94aUzD.js";import{b as re,e as Be,t as ue,a as ae}from"./CXeFc7Ny.js";import{b as Je,s as Fe,a as Ge}from"./CrbL80z1.js";import{o as Ke}from"./NWMzFNKK.js";import{s as Pe}from"./CfeX_JpR.js";import{i as Qe}from"./DGClMfjY.js";function Ue(t,e,r,a=!0){a&&r();for(var n of e)t.addEventListener(n,r);ge(()=>{for(var f of e)t.removeEventListener(f,r)})}function ce(t){var e=me,r=H;Z(null),W(null);try{return t()}finally{Z(e),W(r)}}function vt(t,e,r,a=r){t.addEventListener(e,()=>ce(r));const n=t.__on_r;n?t.__on_r=()=>{n(),a(!0)}:t.__on_r=()=>a(!0),Je()}function _t(t,e){return e}function Ze(t,e,r,a){for(var n=[],f=e.length,s=0;s<f;s++)Ce(e[s].e,n,!0);var i=f>0&&n.length===0&&r!==null;if(i){var u=r.parentNode;Ne(u),u.append(r),a.clear(),S(t,e[0].prev,e[f-1].next)}Re(n,()=>{for(var h=0;h<f;h++){var v=e[h];i||(a.delete(v.k),S(t,v.prev,v.next)),De(v.e,!i)}})}function dt(t,e,r,a,n,f=null){var s=t,i={flags:e,items:new Map,first:null},u=(e&fe)!==0;if(u){var h=t;s=y?D(M(h)):h.appendChild(ye())}y&&X();var v=null,g=!1,c=pe(()=>{var d=r();return Se(d)?d:d==null?[]:le(d)});Ee(()=>{var d=C(c),l=d.length;if(g&&l===0)return;g=l===0;let b=!1;if(y){var E=we(s)===be;E!==(l===0)&&(s=j(),D(s),k(!1),b=!0)}if(y){for(var p=null,w,m=0;m<l;m++){if(I.nodeType===8&&I.data===Ae){s=I,b=!0,k(!1);break}var o=d[m],_=a(o,m);w=ve(I,i,p,null,o,_,m,n,e,r),i.items.set(_,w),p=w}l>0&&D(j())}y||We(d,i,s,n,e,a,r),f!==null&&(l===0?v?se(v):v=ie(()=>f(s)):v!==null&&Te(v,()=>{v=null})),b&&k(!0),C(c)}),y&&(s=I)}function We(t,e,r,a,n,f,s){var G,K,P,Q;var i=(n&Me)!==0,u=(n&(J|B))!==0,h=t.length,v=e.items,g=e.first,c=g,d,l=null,b,E=[],p=[],w,m,o,_;if(i)for(_=0;_<h;_+=1)w=t[_],m=f(w,_),o=v.get(m),o!==void 0&&((G=o.a)==null||G.measure(),(b??(b=new Set)).add(o));for(_=0;_<h;_+=1){if(w=t[_],m=f(w,_),o=v.get(m),o===void 0){var de=c?c.e.nodes_start:r;l=ve(de,e,l,l===null?e.first:l.next,w,m,_,a,n,s),v.set(m,l),E=[],p=[],c=l.next;continue}if(u&&je(o,w,_,n),(o.e.f&q)!==0&&(se(o.e),i&&((K=o.a)==null||K.unfix(),(b??(b=new Set)).delete(o))),o!==c){if(d!==void 0&&d.has(o)){if(E.length<p.length){var R=p[0],A;l=R.prev;var F=E[0],L=E[E.length-1];for(A=0;A<E.length;A+=1)ne(E[A],R,r);for(A=0;A<p.length;A+=1)d.delete(p[A]);S(e,F.prev,L.next),S(e,l,F),S(e,L,R),c=R,l=L,_-=1,E=[],p=[]}else d.delete(o),ne(o,c,r),S(e,o.prev,o.next),S(e,o,l===null?e.first:l.next),S(e,l,o),l=o;continue}for(E=[],p=[];c!==null&&c.k!==m;)(c.e.f&q)===0&&(d??(d=new Set)).add(c),p.push(c),c=c.next;if(c===null)continue;o=c}E.push(o),l=o,c=o.next}if(c!==null||d!==void 0){for(var x=d===void 0?[]:le(d);c!==null;)(c.e.f&q)===0&&x.push(c),c=c.next;var O=x.length;if(O>0){var he=(n&fe)!==0&&h===0?r:null;if(i){for(_=0;_<O;_+=1)(P=x[_].a)==null||P.measure();for(_=0;_<O;_+=1)(Q=x[_].a)==null||Q.fix()}Ze(e,x,he,v)}}i&&xe(()=>{var U;if(b!==void 0)for(o of b)(U=o.a)==null||U.apply()}),H.first=e.first&&e.first.e,H.last=l&&l.e}function je(t,e,r,a){(a&J)!==0&&ee(t.v,e),(a&B)!==0?ee(t.i,r):t.i=r}function ve(t,e,r,a,n,f,s,i,u,h){var v=(u&J)!==0,g=(u&He)===0,c=v?g?Ie(n):$(n):n,d=(u&B)===0?s:$(s),l={i:d,v:c,k:f,a:null,e:null,prev:r,next:a};try{return l.e=ie(()=>i(t,c,d,h),y),l.e.prev=r&&r.e,l.e.next=a&&a.e,r===null?e.first=l:(r.next=l,r.e.next=l.e),a!==null&&(a.prev=l,a.e.prev=l.e),l}finally{}}function ne(t,e,r){for(var a=t.next?t.next.e.nodes_start:r,n=e?e.e.nodes_start:r,f=t.e.nodes_start;f!==a;){var s=oe(f);n.before(f),f=s}}function S(t,e,r){e===null?t.first=r:(e.next=r,e.e.next=r&&r.e),r!==null&&(r.prev=e,r.e.prev=e&&e.e)}function ht(t,e,r=!1,a=!1,n=!1){var f=t,s="";z(()=>{var i=H;if(s===(s=e()??"")){y&&X();return}if(i.nodes_start!==null&&(Le(i.nodes_start,i.nodes_end),i.nodes_start=i.nodes_end=null),s!==""){if(y){I.data;for(var u=X(),h=u;u!==null&&(u.nodeType!==8||u.data!=="");)h=u,u=oe(u);if(u===null)throw Oe(),ke;re(I,h),f=D(u);return}var v=s+"";r?v=`<svg>${v}</svg>`:a&&(v=`<math>${v}</math>`);var g=Be(v);if((r||a)&&(g=M(g)),re(M(g),g.lastChild),r||a)for(;M(g);)f.before(M(g));else f.before(g)}})}function _e(t){var e,r,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(r=_e(t[e]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}function $e(){for(var t,e,r=0,a="",n=arguments.length;r<n;r++)(t=arguments[r])&&(e=_e(t))&&(a&&(a+=" "),a+=e);return a}function gt(t){return typeof t=="object"?$e(t):t??""}function et(t,e,r){var a=t==null?"":""+t;return e&&(a=a?a+" "+e:e),a===""?null:a}function tt(t,e){return t==null?null:String(t)}function rt(t,e,r,a,n,f){var s=t.__className;if(y||s!==r||s===void 0){var i=et(r,a);(!y||i!==t.getAttribute("class"))&&(i==null?t.removeAttribute("class"):t.className=i),t.__className=r}return f}function at(t,e,r,a){var n=t.__style;if(y||n!==e){var f=tt(e);(!y||f!==t.getAttribute("style"))&&(f==null?t.removeAttribute("style"):t.style.cssText=f),t.__style=e}return a}function mt(t,e){Ue(window,["resize"],()=>ce(()=>e(window[t])))}const N=16;function T(t,e){return t?Math.round((e-N/2)/N)*N:e}function yt(t){if(t instanceof TouchEvent){const e=t.touches[0]||t.changedTouches[0];return{x:e.clientX,y:e.clientY}}else if(t instanceof MouseEvent)return{x:t.clientX,y:t.clientY};return{x:0,y:0}}function Et(t,e,r,a,n){const f=Math.abs(T(n,r)-T(n,t)),s=Math.abs(T(n,a)-T(n,e)),i=r<=t?T(n,r):T(n,t),u=a<=e?T(n,a):T(n,e);return{x:i,y:u,wdt:f,hgt:s}}var nt=ue('<span class="recto-numbers svelte-vg4o7q"> </span>'),st=ue('<div><!> <div class="recto-inside svelte-vg4o7q"><!></div></div>');function pt(t,e){qe(e,!0),Ke(async()=>{setTimeout(()=>{const i=document.getElementById(e.id);i instanceof HTMLElement&&(i.style.width="0px",i.style.height="0px")},200)});var r=st(),a=Y(r);{var n=i=>{var u=nt(),h=Y(u);V(u),z((v,g)=>Pe(h,`${v??""}x${g??""}`),[()=>Math.floor(e.wdt/N),()=>Math.floor(e.hgt/N)]),ae(i,u)};Qe(a,i=>{(e.type==="live"||e.type==="invalid")&&i(n)})}var f=Ye(a,2),s=Y(f);Fe(s,()=>e.children),V(f),V(r),z((i,u)=>{Ge(r,"id",e.id),rt(r,1,`recto recto-${e.type}`,"svelte-vg4o7q"),at(r,`transform: translate(${e.x??""}px, ${e.y??""}px); width: ${i??""}px; height: ${u??""}px`)},[()=>e.wdt.toString(),()=>e.hgt.toString()]),ae(t,r),Ve()}const wt=(t,e)=>{let r=Xe(ze(e));{const s=localStorage.getItem(t);s&&te(r,JSON.parse(s),!0)}const a=()=>{C(r)?localStorage.setItem(t,JSON.stringify(C(r))):localStorage.removeItem(t)};return{get:()=>C(r),set:s=>{te(r,s,!0),a()}}};export{pt as R,N as S,Et as a,mt as b,gt as c,at as d,dt as e,yt as g,ht as h,_t as i,vt as l,rt as s,wt as u};
